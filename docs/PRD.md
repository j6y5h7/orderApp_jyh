# 커피 주문 앱

## 1. 프로젝트 개요

### 1.1 프로젝트명
커피 주문 앱

### 1.2 프로젝트 목적
사용자가 커피 메뉴를 주문하고, 관리자가 주문을 관리할 수 있는 간단한 풀스택 웹 앱

### 1.3 개발 범위
- 주문하기 화면(메뉴 선택 및 장바구니 기능)
- 관리자 화면(재고 관리 및 주문 상태 관리)
- 데이터를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스택
- 프론트엔엔드 : HTML, CSS, React, javascript
- 백앤드 : Node.js, Express
- 데이터베이스 : PostgreSQL

## 3.기본 사항
- 프론트엔드와 백엔드를 따로 개발
- 기본적인 웹 기술만 사용
- 학습 목적이므로 사용자 인증이나 결제 기능은 제외
- 메뉴는 커피 메뉴만 있음

## 4. 주문하기 화면 PRD

### 4.1 개요
- **화면명**: 주문하기
- **목적**: 사용자가 카페 메뉴를 선택하고 옵션을 추가하여 장바구니에 담고, 최종 주문을 생성할 수 있는 화면
- **대상 사용자**: 일반 고객(매장 내 키오스크/태블릿 혹은 웹·모바일 앱 사용자)
- **관련 화면**: 관리자 화면(메뉴/가격 관리 등) – 본 문서에서는 연동 포인트만 간단히 언급

### 4.2 목표 및 성공 기준
- **주요 목표**
  - 사용자가 3회 이내의 주요 조작으로 주문을 완료할 수 있도록 직관적인 플로우 제공
  - 장바구니 정보(상품, 옵션, 수량, 금액)를 한눈에 파악할 수 있도록 구성
- **성공 지표 예시**
  - 주문하기 화면 진입 후 **완료 주문 전환율 70% 이상**
  - 주문하기 화면에서의 **평균 체류 시간 3분 이내**
  - 옵션/수량/상품 선택 관련 오류(유효성 검증 실패) 비율 **5% 미만**

### 4.3 사용자 플로우
1. 사용자가 상단 탭에서 `주문하기`를 선택해 진입한다.
2. 오늘 주문 가능한 **메뉴 카드 리스트**가 표시된다.
3. 사용자는 각 메뉴 카드에서
   - 메뉴 정보(이름, 가격, 설명)를 확인하고
   - 옵션(예: 샷 추가, 시럽 추가)을 선택한 뒤
   - `담기` 버튼으로 장바구니에 추가한다.
4. 하단의 **장바구니 영역**에서
   - 담긴 상품 목록 및 옵션, 수량, 개별 금액을 확인하고
   - 총 금액을 확인하며
   - 필요 시 항목 삭제 / 수량 변경을 수행한다.
5. 사용자가 `주문하기` 버튼을 누르면
   - 주문 확인 및 생성 절차가 수행되고
   - 성공 시 주문 완료 화면(또는 팝업)이 노출되며
   - 실패 시 에러 메시지가 노출된다.

### 4.4 기능 요구사항

#### 4.4.1 공통 레이아웃
- **상단 브랜드 영역**
  - 화면 좌측 상단에 브랜드명 텍스트 표시: 예) `COZY`
  - 클릭/터치 시 별도 동작 없음(로고 역할)

- **탭(주문하기 / 관리자)**
  - 상단 우측에 `주문하기`, `관리자` 두 개의 탭 버튼을 배치한다.
  - 현재 화면이 `주문하기`일 때 해당 탭에 **선택 상태 스타일**을 적용한다.
  - 다른 탭 클릭 시 해당 화면으로 이동한다(내비게이션 기능).

#### 4.4.2 메뉴 목록
- **메뉴 카드 리스트**
  - 최소 1개 이상의 메뉴 카드가 나열된다(반응형 레이아웃 허용).
  - 각 메뉴 카드는 다음 정보를 포함한다.
    - 메뉴 대표 이미지
    - 메뉴명: 예) `아메리카노(ICE)`, `아메리카노(HOT)`, `카페라떼`
    - 기본 가격: 예) `4,000원`, `5,000원`
    - 간단한 설명 텍스트(최대 2~3줄)
    - 옵션 리스트(체크박스 형태)
      - 예) `샷 추가 (+500원)`, `시럽 추가 (+0원)`
    - `담기` 버튼

- **옵션 선택**
  - 각 옵션은 **체크박스**로 표시한다.
  - 옵션 선택/해제 시, 장바구니에 담길 때 **옵션 가격이 반영된 최종 금액**으로 계산되어야 한다.
  - 옵션 속성
    - 이름(예: 샷 추가)
    - 추가 금액(예: +500원, +0원)
    - 다중 선택 허용 여부(기본: 다중 선택 가능)

- **담기 버튼 동작**
  - 사용자가 메뉴 카드에서 원하는 옵션을 선택한 후 `담기`를 누르면:
    - 해당 메뉴와 선택된 옵션이 장바구니에 **수량 1개**로 추가된다.
    - 이미 동일한 조합(동일 메뉴 + 동일 옵션 세트)이 존재하면 수량만 **+1 증가**한다.
    - 추가 완료 후 토스트 메시지 등으로 피드백을 제공한다.

#### 4.4.3 장바구니
- **표시 위치/형태**
  - 화면 하단에 카드형 박스로 고정 배치한다.
  - 제목: `장바구니`

- **장바구니 항목 정보**
  - 각 줄에 다음 정보를 표시한다.
    - 메뉴명 및 옵션 요약: 예) `아메리카노(ICE) (샷 추가)  X 1`
    - 오른쪽 정렬로 해당 항목의 **소계 금액**: 예) `4,500원`
  - 항목별 금액 계산 규칙
    - (기본 가격 + 선택 옵션 추가 금액 합계) × 수량

- **수량 조절 기능**
  - 각 항목 옆에 `+`, `-` 버튼 또는 입력/셀렉트 UI로 수량을 조절한다.
  - 수량이 1에서 `-`를 클릭하면 해당 항목을 삭제하는 것을 기본 정책으로 한다.

- **항목 삭제 기능**
  - 별도의 `삭제` 아이콘 또는 `X` 버튼을 제공하여 항목을 개별 삭제할 수 있다.

- **총 금액 영역**
  - 장바구니 우측 영역에 `총 금액` 라벨과 값을 표시한다.
  - 총 금액 계산:
    - 모든 항목의 \((기본 가격 + 옵션 추가 금액 합계) × 수량\)을 합산한다.
  - 금액 단위는 원(정수)만 사용한다.

- **장바구니 내 주문하기 버튼**
  - 장바구니 우측 하단에 `주문하기` 버튼을 배치한다.
  - 장바구니가 비어 있으면 비활성화(클릭 불가) 상태로 표시한다.
  - 항목이 1개 이상 존재하면 활성화된다.

#### 4.4.4 주문 처리
- **주문 생성 플로우**
  - 사용자가 `주문하기` 버튼을 누르면:
    1. 장바구니 내용 검증(빈 장바구니 여부, 가격 재계산 등)
    2. 서버에 주문 생성 API 호출(주문 항목, 옵션, 수량, 총 금액, 주문 시각 등)
    3. 응답 상태에 따른 분기 처리

- **주문 성공 시**
  - 주문 완료 전용 화면 또는 모달을 표시한다(주문 번호, 예상 준비 시간 등).
  - 성공 후 장바구니는 **비워진 상태**로 초기화한다.

- **주문 실패 시**
  - 에러 메시지를 화면에 표시한다.
    - 예) `주문 처리 중 오류가 발생했습니다. 잠시 후 다시 시도해 주세요.`
  - 네트워크 장애 시 재시도 버튼을 제공할 수 있다(선택 사항).

### 4.5 비기능 요구사항
- **반응 속도**
  - 메뉴/장바구니 조작(담기, 삭제, 수량 변경)은 1초 이내에 시각적 피드백을 제공한다.
- **안정성**
  - 네트워크/서버 오류 발생 시 사용자에게 명확한 안내 메시지를 제공한다.
- **접근성**
  - 주요 버튼(`담기`, `주문하기`, 수량 조절 등)은 터치 환경 기준 최소 44px 크기를 확보한다.
  - 텍스트와 배경의 색상 대비를 충분히 확보한다.

### 4.6 데이터 모델 초안

#### 4.6.1 메뉴 데이터 구조 예시
- `id`: 메뉴 고유 ID
- `name`: 메뉴명 (예: 아메리카노(ICE))
- `price`: 기본 가격(정수, 원 단위)
- `description`: 간단 설명
- `imageUrl`: 이미지 경로
- `options`: 옵션 배열
  - `id`
  - `name` (예: 샷 추가)
  - `extraPrice` (정수, 원 단위)
  - `defaultSelected` (기본 선택 여부, 기본값: false)

#### 4.6.2 장바구니 아이템 구조 예시
- `cartItemId`: 장바구니 항목 고유 ID
- `menuId`: 메뉴 ID 참조
- `selectedOptions`: 선택한 옵션 ID 리스트
- `quantity`: 수량
- `unitPrice`: 옵션 포함 1개 기준 가격  
  - `unitPrice = menu.price + sum(option.extraPrice)`
- `lineTotal`: `unitPrice * quantity` (표시/전송 시 계산 가능)

### 4.7 엣지 케이스 및 정책
- **품절 메뉴**
  - 품절일 경우 목록에서 비활성화 표시 또는 숨김 중 하나를 선택한다.
  - 비활성화 정책 선택 시 `담기` 버튼 비활성 + `품절` 뱃지를 표시한다.
- **가격 변경 타이밍**
  - 주문 도중 관리자가 가격을 변경한 경우, 주문 요청 시 서버에서 가격을 재검증하고 불일치 시 사용자에게 안내한다.
- **동시성**
  - 같은 계정에서 여러 기기에서 동시에 주문하는 경우, 서버에서 최종 금액과 수량을 기준으로 처리한다.

## 5. 관리자 화면 PRD

### 5.1 개요
- **화면명**: 관리자
- **목적**: 관리자가 주문 현황을 한눈에 파악하고, 재고를 조절하며, 주문을 접수·진행·완료 처리할 수 있는 화면
- **대상 사용자**: 매장 관리자(점주, 바리스타 등)
- **관련 화면**: 주문하기 화면(고객 주문 생성) – 주문 데이터·재고 데이터와 연동

### 5.2 목표 및 성공 기준
- **주요 목표**
  - 주문 상태(접수/제조 중/제조 완료)를 한 화면에서 확인·변경할 수 있도록 한다.
  - 메뉴별 재고 수량을 실시간으로 조절할 수 있도록 한다.
- **성공 지표 예시**
  - 관리자 화면에서 주문 접수·상태 변경이 **1회 조작**으로 완료된다.
  - 재고 수량 변경이 **즉시 반영**되어 주문하기 화면(품절/판매 가능)과 일치한다.

### 5.3 사용자 플로우
1. 관리자가 상단 탭에서 `관리자`를 선택해 진입한다.
2. **관리자 대시보드**에서 총 주문·접수·제조 중·제조 완료 건수를 확인한다.
3. **재고 현황**에서 각 메뉴별 재고 수량을 확인하고, `+`/`-` 버튼으로 수량을 조절한다.
4. **주문 현황**에서 대기 중인 주문 목록을 확인하고, `주문 접수` 등 버튼으로 상태를 변경한다.
5. (추가 구현 시) 접수된 주문을 `제조 중` → `제조 완료`로 단계별 변경한다.

### 5.4 기능 요구사항

#### 5.4.1 공통 레이아웃
- **상단 브랜드 영역**
  - 화면 좌측 상단에 브랜드명 `COZY` 표시.
  - 주문하기 화면과 동일한 스타일 유지.
- **탭(주문하기 / 관리자)**
  - 상단 우측에 `주문하기`, `관리자` 탭 배치.
  - 현재 화면이 `관리자`일 때 `관리자` 탭에 **선택 상태 스타일**(예: 테두리 강조) 적용.
  - `주문하기` 탭 클릭 시 주문하기 화면으로 이동.

#### 5.4.2 관리자 대시보드
- **섹션 제목**
  - `관리자 대시보드` 라벨 표시.
- **주문 상태 요약 지표**
  - 다음 네 가지 지표를 가로로 나열하여 표시한다.
    - **총 주문**: 생성된 전체 주문 건수(접수·제조 중·제조 완료 포함).
    - **주문 접수**: 접수 완료된 주문 건수(제조 대기 포함).
    - **제조 중**: 현재 제조 중인 주문 건수.
    - **제조 완료**: 제조 완료된 주문 건수.
  - 각 지표는 숫자로만 표시해도 되며, 라벨과 함께 표시한다(예: `총 주문 1`, `주문 접수 1`, `제조 중 0`, `제조 완료 0`).
  - 데이터는 서버/DB와 연동하여 실시간 또는 새로고침 시 갱신한다.

#### 5.4.3 재고 현황
- **섹션 제목**
  - `재고 현황` 라벨 표시.
- **재고 카드 목록**
  - 메뉴(또는 재고 품목)별로 카드 형태로 나열한다.
  - 와이어프레임 예시: 아메리카노(ICE), 아메리카노(HOT), 카페라떼.
- **각 재고 카드 구성**
  - **품목명**: 메뉴명 표시(예: 아메리카노(ICE), 아메리카노(HOT), 카페라떼).
  - **현재 재고 수량**: 숫자 + 단위(예: `10개`)로 표시.
  - **수량 조절 UI**
    - `+` 버튼: 클릭 시 해당 품목 재고 수량 1 증가.
    - `-` 버튼: 클릭 시 해당 품목 재고 수량 1 감소.
    - 재고는 0 미만으로 내려가지 않도록 제한(0에서 `-` 클릭 시 0 유지 또는 비활성화).
- **저장 방식**
  - 버튼 클릭 시 즉시 서버/DB에 반영하거나, 카드별/전체 `저장` 버튼으로 일괄 반영 중 하나를 선택한다.
  - 반영 후 주문하기 화면의 품절/판매 가능 상태와 일치시킨다(재고 0이면 해당 메뉴 품절 처리 등).

#### 5.4.4 주문 현황
- **섹션 제목**
  - `주문 현황` 라벨 표시.
- **주문 카드 목록**
  - 대기 중이거나 접수·제조 중·제조 완료 상태인 주문을 카드 형태로 나열한다.
  - 정렬: 최신 주문 순(또는 주문 시각 오름차순) 등 정책을 정한다.
- **각 주문 카드 구성**
  - **주문 시각**: 예) `7월 31일 13:00` 형식으로 표시.
  - **주문 항목 및 수량**: 예) `아메리카노(ICE) x 1` (여러 항목이면 줄바꿈 또는 쉼표로 구분).
  - **가격**: 해당 주문의 총 금액, 예) `4,000원`.
  - **액션 버튼**
    - **주문 접수**: 주문 상태가 '대기' 또는 '미접수'일 때 표시. 클릭 시 해당 주문을 '주문 접수' 상태로 변경.
    - (확장) **제조 중**: 접수된 주문을 제조 중으로 변경하는 버튼.
    - (확장) **제조 완료**: 제조 중인 주문을 제조 완료로 변경하는 버튼.
- **상태별 표시**
  - 접수/제조 중/제조 완료 상태에 따라 카드 스타일(색상·뱃지) 또는 버튼 라벨을 다르게 할 수 있다.

### 5.5 비기능 요구사항
- **반응 속도**
  - 재고 +/- 클릭, 주문 접수(또는 상태 변경) 클릭 시 1초 이내 시각적 피드백(로딩 또는 상태 갱신).
- **데이터 일관성**
  - 재고 변경 시 주문하기 화면의 메뉴 품절/판매 가능 상태와 동기화.
  - 주문 상태 변경 시 대시보드 지표(총 주문, 주문 접수, 제조 중, 제조 완료)가 즉시 갱신되도록 한다.
- **접근성**
  - 버튼(`+`, `-`, 주문 접수 등)은 터치 시 인식하기 쉬운 크기(최소 44px 권장)로 제공.

### 5.6 데이터 모델·연동 초안
- **재고(inventory)**
  - 메뉴(또는 품목) ID, 현재 수량(stock). 필요 시 최소/최대 수량 필드 추가.
- **주문 상태**
  - 주문 ID, 상태(예: `pending` / `accepted` / `in_progress` / `completed`), 주문 시각, 주문 항목·수량·금액 등.
- **대시보드 지표**
  - 총 주문: 상태 무관 전체 카운트.
  - 주문 접수: `accepted` (또는 동일 의미) 상태 카운트.
  - 제조 중: `in_progress` 카운트.
  - 제조 완료: `completed` 카운트.
  - (정책에 따라 `pending`만 별도 표시할지 결정)

### 5.7 엣지 케이스 및 정책
- **재고 0**
  - 재고가 0인 메뉴는 주문하기 화면에서 품절 처리(비활성화 또는 숨김). 관리자 화면에서는 0으로 표시하고 `-` 버튼 비활성화.
- **동시 주문 접수**
  - 여러 관리자 또는 여러 탭에서 동시에 같은 주문을 접수하지 않도록, 접수 시 낙관적 잠금 또는 서버 검증으로 한 번만 접수되게 한다.
- **주문 목록 비어 있음**
  - 주문이 없을 때는 "주문이 없습니다" 등의 안내 문구를 표시한다.

---

## 6. 백엔드 개발을 위한 PRD

### 6.1 데이터 모델

백엔드·데이터베이스 설계 시 아래 엔티티를 기준으로 한다.

#### 6.1.1 Menus (메뉴)
- **커피 이름**: 메뉴명 (예: 아메리카노(ICE), 카페라떼)
- **설명**: 메뉴에 대한 간단한 설명 텍스트
- **가격**: 기본 가격(정수, 원 단위)
- **이미지**: 이미지 URL 또는 경로
- **재고 수량**: 현재 재고 개수 (관리자 화면에서 표시·조절, 주문 시 차감)

#### 6.1.2 Options (옵션)
- **옵션 이름**: 옵션명 (예: 샷 추가, 시럽 추가)
- **옵션 가격**: 추가 금액(정수, 원 단위)
- **연결할 메뉴**: 해당 옵션을 제공하는 메뉴와의 연결(메뉴 ID 또는 N:M 관계 등)

#### 6.1.3 Orders (주문)
- **주문 일시**: 주문이 접수된 날짜·시간
- **주문 내용**: 다음을 포함
  - **메뉴**: 주문된 메뉴(메뉴 ID 또는 스냅샷 메뉴명)
  - **수량**: 해당 메뉴의 주문 수량
  - **옵션**: 선택된 옵션(옵션 ID 또는 스냅샷 옵션명)
  - **금액**: 해당 항목의 단가 또는 소계
- (선택) **주문 상태**: 주문 접수 / 제조 중 / 제조 완료
- (선택) **총 금액**: 주문 전체 합계

---

### 6.2 데이터 스키마를 위한 사용자 흐름

아래 흐름에 맞게 Menus, Options, Orders를 설계·연동한다.

1. **메뉴 목록 표시**
   - **Menus**에 저장된 정보를 조회하여 브라우저(주문하기 화면)에 표시한다.
   - 이때 Menus의 **재고 수량**은 주문하기 화면에는 품절 여부 판단용으로만 사용하고, **재고 수량 값 자체는 관리자 화면**에서만 표시한다.

2. **장바구니**
   - 사용자가 앱 화면에서 커피 메뉴를 선택해 담으면, 선택 정보는 **클라이언트 장바구니**에만 두고 화면에 표시한다.
   - (서버에는 아직 저장하지 않음)

3. **주문 저장**
   - 장바구니에서 **주문하기** 버튼을 클릭하면, 주문 정보를 **Orders**에 저장한다.
   - Orders에는 **주문 시간**과 **주문 내용(메뉴, 수량, 옵션, 금액)**을 저장한다.
   - 주문 저장 시 주문된 메뉴·수량에 따라 **Menus의 재고 수량**을 수정(차감)한다.

4. **관리자 주문 현황**
   - **Orders**에 저장된 정보를 관리자 화면의 **주문 현황**에 표시한다.
   - 주문의 기본 상태는 **주문 접수**이다.
   - 관리자가 **제조시작**을 클릭하면 상태가 **제조 중**으로, **제조 완료**를 클릭하면 **완료**로 변경되도록 한다.

---

### 6.3 API 설계

백엔드 구현 시 아래 API를 제공한다.

| 구분 | 설명 | 비고 |
|------|------|------|
| **메뉴 목록 조회** | 주문하기 화면에서 메뉴를 클릭(진입)할 때, 데이터베이스에서 커피 메뉴 목록(및 연결된 옵션)을 조회하여 클라이언트에 반환한다. | 재고 수량은 관리자용 API에서만 반환하거나, 주문하기용 응답에는 품절 여부(0/1 등)만 포함할 수 있다. |
| **주문 생성** | 사용자가 커피를 선택하고 **주문하기** 버튼을 누르면, 전달받은 주문 정보(메뉴, 수량, 옵션, 금액, 주문 시각 등)를 데이터베이스의 **Orders**에 저장한다. | 검증 실패 시 4xx, 성공 시 201 및 주문 ID 등 반환. |
| **재고 수정** | 주문 생성 시, 주문 내용에 따라 **Menus**의 해당 메뉴 **재고 수량**을 차감한다. 관리자가 재고를 +/- 하는 API도 별도로 두면 관리자 화면과 연동 가능. | 트랜잭션으로 주문 저장과 재고 차감을 함께 처리하는 것을 권장. |
| **주문 단건 조회** | **주문 ID**를 전달하면 해당 주문 정보(주문 일시, 주문 내용, 상태, 총 금액 등)를 반환한다. | 관리자 화면 상세 또는 주문 완료 화면에서 활용. |

- 위 API는 REST(또는 팀 합의 방식)로 설계하며, 요청/응답 스키마는 Menus, Options, Orders 모델과 맞춘다.
- 프론트엔드는 4장·5장 PRD에 따라 위 API를 호출하여 주문하기·관리자 화면을 연동한다.

  